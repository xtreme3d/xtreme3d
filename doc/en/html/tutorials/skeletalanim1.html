<HTML>
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<TITLE>Скелетная анимация 1</TITLE>
<LINK href="../data/style.css" type=text/css rel=stylesheet>
</HEAD>
<BODY>

<DIV ALIGN=justify>

<H1 class=pagetitle>Урок 9<BR>Основы скелетной анимации</H1>

<A><B>Уровень:</B> начинающий</A>
<BR><A><B>Версия Xtreme3D:</B> 3.0.x</A>
<BR><A><B>Автор урока:</B> Gecko</A><A class=ntext>
<BR>
<BR>Порой возможностей вертексной анимации оказывается недостаточно. Это касается, в основном, 
игр жанра action. Например, вы можете захотеть "дать" своему герою в руки оружие или "надеть" на него броню. 
При использовании вершинной анимации это невозможно (за редкими исключениями). Кроме того, вершинная 
анимация может потребовать слишком много памяти для хранения кадров. 
Поэтому, если вы используете модели с большим количеством полигонов, разумнее будет выбрать скелетную анимацию.
<BR>Вместо того чтобы хранить ключевые кадры (как в случае вертексной анимации) для каждой позы персонажа, 
использование скелетной анимации подразумевает наличие одной модели в нейтральной позе и большого набора матриц, 
которые трансформируют различные части этой модели. Эти матрицы условно называют костями. К каждой кости 
привязана группа вершин. Одна вершина может "принадлежать" нескольким костям сразу, с разной степенью влияния, 
что делает анимацию более естественной (это свойство костей называется развесовкой). 
<BR>Впервые эта технология использовалась в игре Half-Life, и Xtreme3D поддерживает формат моделей Half-Life - SMD.  
В качестве альтернативы SMD, поддерживается также формат моделей Doom III - MD5. 
<BR>
<BR>Для загрузки моделей со скелетной анимацией используется тот же объект Actor. Вам не нужно ничего 
дополнительно указывать, Xtreme3D способен самостоятельно распознать тип модели и настроиться на соответствующий 
тип анимации:
<BR>
<BR><A>actor = </A><A class=func2link href=../functions/actor.htm#ActorCreate>ActorCreate</A><A>('model.smd', matlib, matlib, <B>global.</B>scene);</A>
<BR>
<BR>Особенность формата SMD заключается в том, что анимация модели хранится в отдельном файле, который также 
имеет расширение *.smd. Таких файлов может быть несколько. Теоретически, такой метод позволяет использовать 
одни и те же файлы анимации для разных моделей (если они имеют одинаковый скелет). 
<BR>После создания Актера следует добавить эти файлы:
<BR>
<BR><A class=func2link href=../functions/actor.htm#ActorAddObject>ActorAddObject</A><A>(actor, 'animation1.smd');</A>
<BR><A class=func2link href=../functions/actor.htm#ActorAddObject>ActorAddObject</A><A>(actor, 'animation2.smd');</A>
<BR><A class=func2link href=../functions/actor.htm#ActorAddObject>ActorAddObject</A><A>(actor, 'animation3.smd');</A>
<BR>
<BR>При добавлении очередного smd-файла, к анимации Актера добавляется новая группа кадров, которой присваивается 
порядковый номер. Отсчет ведется с 1. То есть, если мы теперь переключимся на группу 2:
<BR>
<BR><A class=func2link href=../functions/actor.htm#ActorSwitchToAnimation>ActorSwitchToAnimation</A><A>(actor, 2, </A><A class=constant>false</A><A>);</A>
<BR>
<BR>...то будет проиграна анимация, загруженная из файла animation2.smd.
<BR>
<BR>К скелетной анимации применимы все функции, которые мы рассмотрели на предыдущем уроке. 
<!--
Вы также можете работать с отдельными костями скелета. Например, следующая функция локально поворачивает кость 3 на 90 градусов по оси X:
<BR>
<BR></A><A class=func2link href=../functions/actor.htm#ActorRotateBone>ActorRotateBone</A><A>(actor, 3, 90, 0, 0);
<BR>
<BR>А чтобы локально переместить кость, например, на 3 единицы по оси Y, нужно написать так:
<BR>
<BR></A><A class=func2link href=../functions/actor.htm#ActorMoveBone>ActorMoveBone</A><A>(actor, 3, 0, 3, 0);
<BR>
<BR>Правда, не всегда удобно использовать индексы костей - их трудновато запомнить. SMD позволяет дать кости 
уникальное имя, по которому в Xtreme3D можно вернуть ее индекс:
<BR>
<BR>bone_hand=</A><A class=func2link href=../functions/actor.htm#ActorGetBoneByName>ActorGetBoneByName</A><A>(actor, 'boneHand');
<BR></A><A class=func2link href=../functions/actor.htm#ActorRotateBone>ActorRotateBone</A><A>(actor, bone_hand, 90,0,0);
<BR>
-->
<!--
Позднее мы рассмотрим способ получить абсолютные координаты и углы поворота костей - для того, чтобы можно было 
"прикреплять" к ним различные сторонние объекты.
-->
</A>

</DIV>

</BODY>
</HTML>
