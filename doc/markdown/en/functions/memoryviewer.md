# MemoryViewer

MemoryViewer (внеэкранный вид) аналогичен обычному виду (Viewer), но предназначен для рендеринга сцены в буфер в видеопамяти - так называемый offscreen buffer или p-buffer. Содержимое этого буфера затем может быть скопировано в текстуру материала. Главное предназначение MemoryViewer - эффекты пост-обработки, но ему можно найти множество других применений.

---

## MemoryViewerCreate

`real MemoryViewerCreate(real width, real height);`

Создает новый внеэкранный вид и возвращает указатель на него.

- `width`, `height` - ширина и высота внеэкранного вида (размер p-буфера).

---

## MemoryViewerSetCamera

`real MemoryViewerSetCamera(real memviewer, real camera);`

Задает камеру, через которую внеэкранный вид должен рендерить сцену.

- `memviewer` - указатель на внеэкранный вид
- `camera` - указатель на камеру.

---

## MemoryViewerSetViewport

`real MemoryViewerSetViewport(real memviewer, real x, real y, real width, real height);`

Задает позицию и размер вьюпорта - области проекции сцены, которую нужно отрендерить: вы можете отрендерить не весь кадр, а только его фрагмент.

Обратите внимание, что размер вьюпорта и размер p-буфера - это разные вещи: MemoryViewer может рендерить вьюпорт размером больше, чем буфер - в этом случае кадр будет соответствующим образом масштабирован, чтобы уместиться в буфер. Это позволяет создавать эффекты пост-обработки с небольшим p-буфером даже при фактическом рендеринге в высоком разрешении - например, с буфером 128х128 при разрешении 1280х720 (правда, чем больше эта разница, тем ниже качество).

Эту функцию нужно вызывать каждый раз перед тем, как отрендерить внеэкранный вид (так как вьюпорт каждый раз переназначается при рендеринге обычного экранного вида).

- `memviewer` - указатель на внеэкранный вид
- `x`, `y` - позиция вьюпорта. Задается относительно левого верхнего угла.
- `width`, `height` - размер вьюпорта.

---

## MemoryViewerRender

`real MemoryViewerRender(real memviewer);`

Совершает отрисовку сцены во внеэкранный вид. Обратите внимание, что будут отрисованы все видимые объекты сцены, включая экранные (текст и спрайты) - если вам это не нужно, то предварительно отключите их видимость.

- `memviewer` - указатель на внеэкранный вид.

---

## MemoryViewerCopyToTexture

`real MemoryViewerCopyToTexture(real memviewer, string material);`

Копирует содержимое буфера кадра внеэкранного вида в текстуру заданного материала. Текстура должна быть предварительно создана функцией `MaterialGenTexture`. Размер текстуры должен соответствовать размеру внеэкранного вида.

- `memviewer` - указатель на внеэкранный вид
- `material` - имя материала.
