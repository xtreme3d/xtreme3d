# Font and Text

Шрифт и текст. Xtreme3D поддерживает три типа текстовых объектов: плоский, объемный и экранный. Экранный текст (HUDText) отображается поверх отрендеренной картинки и применяется для представления некоей текстовой информации в игре: количество жизней или патронов, различных сообщений и пр. Плоский текст (FlatText) и объемный (SpaceText) располагаются в трехмерном пространстве. Объемный, в отличие от плоского, имеет толщину.

Все типы текста используют специальные шрифтовые объекты, хранящие изображения текстовых символов - букв, цифр и знаков препинания. В Xtreme3D поддерживается три вида шрифтовых объектов: Bmpfont, WindowsBitmapfont и TTFont. 
Шрифт-изображение (Bmpfont) представляет собой одну большую текстуру с символьной "сеткой", в которую заранее записаны изображения символов. Ее можно создать вручную в графическом редакторе, нарисовать символы любого цвета и сложности. Однако такой шрифт содержит ограниченный диапазон символов - обычно только таблицу ASCII, которая включает латинский алфавит, цифры и стандартные знаки препинания. Теоретически, диапазон может быть расширен с использованием кодовых страниц, но это решение не сработает, если вам нужно выводить текст с символами из нескольких разных алфавитов - то есть, при использовании в приложении русского языка нельзя, например, выводить греческие буквы.

Полноценно эта проблема решается только с использованием Юникода, где каждый символ имеет свой уникальный код. В Xtreme3D поддержка Юникода реализована в виде шрифтового объекта TTFont, основанного на библиотеке [SDL_ttf](https://github.com/libsdl-org/SDL_ttf) - он создается из произвольного TTF-файла и по необходимости динамически подгружает любые символы, которые вы захотите вывести, хоть китайские иероглифы (если, конечно, они поддерживаются вашим шрифтом).

TTFont поддерживает входной текст в кодировке UTF-8, либо в системной кодировке Windows (по умолчанию используется кодовая страница 1251, но вы можете загрузить файл перекодирования с реализацией любой 8-битной кодировки функцией `TTFontLoadCodePage`).

В целях обратной совместимости (и работы с объемным 3D-текстом) оставлен также третий вид шрифтовых объектов - системный (WindowsBitmapfont). Это, фактически, Bmpfont, который автоматически генерируется из указанного системного шрифта, установленного в Windows. Данный вид шрифтов также работает только с кодовыми страницами Windows и, к тому же, не может загружать шрифты из произвольных TTF-файлов, поэтому для экранного текста вместо него рекомендуется использовать TTFont.

Обратите также внимание, что Xtreme3D, в отличие от встроенных функций GML, не распознает в строковых значениях символ # как переход на следующую строку. Вместо него рекомендуется использовать тринадцатый символ ASCII - `chr(13)`. Например:

```gml
HUDTextSetText(text, "line 1" + chr(13) + "line 2").
```

---

## BmpfontCreate

`real BmpfontCreate(real width, real height, real hspace, real vspace, real intx, real inty, real start, real end);`

Создает новый шрифт и возвращает указатель на него.

- `width`, `height` - ширина и высота символа в пикселях
- `hspace`, `vspace` - промежуток между символами по горизонтали и вертикали в пикселях
- `inx`, `inty` - координаты начала отсчета символов (крайняя верхняя левая точка)
- `start`, `end` - номера первого и последнего символа. Для латиницы эти значения соответствуют 32 и 95.

---

## BmpfontLoad

`real BmpfontLoad(real font, string material);`

Загружает изображение шрифта из текстуры указанного материала.

- `font` - ссылка на указатель шрифта
- `material` - имя материала.

---

## TTFontCreate

`real TTFontCreate(string filename, real height);`

Создает новый TTF-шрифт и возвращает указатель на него.

- `filename` - имя файла TTF
- `height` - кегль (размер) шрифта в пикселях.

---

## TTFontSetLineGap

`real TTFontSetLineGap(real ttf, real gap);`

Задает междустрочный интервал TTF-шрифта, который используется при выводе многострочного текста. Интервал задается не в пикселях, а в долях от кегля шрифта - то есть, значение 1 соответствует интервалу, равному высоте одной строки текста.

- `ttf` - указатель на TTF-шрифт
- `gap` - междустрочный интервал.

---

## WindowsBitmapfontCreate

`real WindowsBitmapfontCreate(string fontname, real size, real start, real end);`

Загружает системный шрифт Windows и возвращает указатель на него.

- `fontname` - название шрифта, например: "Arial"
- `size` - размер шрифта
- `start`, `end` - номера первого и последнего символа. Для латиницы эти значения соответствуют 32 и 95.

---

## FlatTextCreate

`real FlatTextCreate(real font, string str, real parent);`

Создает плоский трехмерный текст и возвращает указатель на него.

- `font` - указатель на объект шрифта
- `str` - текстовая строка для отображения
- `parent` - указатель на родителя для текстового объекта (0 - отсутствие родителя).

---

## FlatTextSetFont

`real FlatTextSetFont(real text, real font);`

Задает шрифт плоского текста.

- `text` - указатель на объект текста
- `font` - указатель на объект шрифта.

---

## FlatTextSetColor

`real FlatTextSetColor(real text, real color, real alpha);`

Задает цвет плоского текста.

- `font` - указатель на объект текста
- `color` - цвет
- `alpha` - прозрачность.

---

## FlatTextSetText

`real FlatTextSetText(real text, string str);

Задает текстовую строку для отображения плоским текстом.

- `text` - указатель на объект текста
- `str` - текстовая строка.

---

## HUDTextCreate

`real HUDTextCreate(real font, string str, real parent);`

Создает экранный текст и возвращает ссылку на него.

- `font` - указатель на объект шрифта
- `str` - текстовая строка для отображения
- `parent` - указатель на родителя для текстового объекта (0 - отсутствие родителя).

---

## HUDTextSetRotation

`real HUDTextSetRotation(real text, real angle);`

Задает угол поворота экранного текста.

`text` - указатель на объект текста
`angle` - угол поворота в градусах.

---

## HUDTextSetFont

`real HUDTextSetFont(real text, real font);`

Задает шрифт экранного текста.

- `text` - указатель на объект текста
- `font` - указатель на объект шрифта.

---

## HUDTextSetColor

`real HUDTextSetColor(real text, real color, real alpha);`

Задает цвет экранного текста.

- `font` - указатель на объект текста
- `color` - цвет
- `alpha` - прозрачность.

---

## HUDTextSetText

`real HUDTextSetText(real text, string str);`

Задает текстовую строку для отображения экранным текстом.

- `text` - указатель на объект текста
- `str` - текстовая строка.

---

## SpaceTextCreate

`real SpaceTextCreate(real font, string str, real extrusion, real parent);`

Создает объемный трехмерный текст и возвращает ссылку на него.

- `font` - указатель на объект шрифта. Поддерживается только WindowsBitmapfont
- `str` - текстовая строка для отображения
- `extrusion` - толщина текста
- `parent` - указатель на родителя для текстового объекта (0 - отсутствие родителя).

---

## SpaceTextSetExtrusion

`real SpaceTextSetExtrusion(real text, real extrusion);`

Задает толщину объемного текста.

- `text` - указатель на объект текста
- `extrusion` - толщина текста.

---

## SpaceTextSetFont

`real SpaceTextSetFont(real text, real font);`

Задает шрифт объемного текста.

- `text` - указатель на объект текста
- `font` - указатель на объект шрифта.

---

## SpaceTextSetText

`real SpaceTextSetText(real text, string str);`

Задает текстовую строку для отображения объемным текстом.

- `text` - указатель на объект текста
- `str` - текстовая строка.
