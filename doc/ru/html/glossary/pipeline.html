<HTML>
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<TITLE>Pipeline</TITLE>
<LINK href="../data/style.css" type=text/css rel=stylesheet>
</HEAD>
<BODY>

<DIV ALIGN=justify>

<H1 class=name>Pipeline</H1>
<A class=type>Pipeline | Конвейер</A>
<HR>
<A>
Пошаговый метод рендеринга 3D-графики (растеризации). Свое название получил из-за того, что выходные данные каждого шага (стадии) являются входными для следующего. 
<BR>
<BR>1. Трансформация. Эта стадия начинает вершинный конвейер, где единицей обработки является вершина (точка в аффинном пространстве). Набор вершин, формирующих трехмерный объект, переводится из модельного пространства в мировое, а затем - в видовое, где началом координат является позиция камеры (эти два преобразования обычно совмещаются в одно). Полученные вершины переводятся перспективной матрицей в пространство отсечения. В программируемом конвейере стадия трансформации производится в вершинном шейдере.
<BR>2. Отсечение. Невидимые вершины (выходящие за пределы пирамиды видимости) отбрасываются и не передаются дальше.
<BR>3. Нормализация. Из пространства отсечения вершины переводятся в нормализованные координаты устройства (NDC) - то есть, фактически, в двумерные координаты на экранной плоскости + координата Z, обозначающая глубину относительно экранной плоскости.
<BR>4. Растеризация. Полученный набор точек используется для растеризации полигонов (обычно треугольников) по заданным правилам построения ребер. В программируемом конвейере эти правила могут быть заданы в геометрическом шейдере. Также на этой стадии происходит интерполяция вершинных атрибутов (цвет, нормаль, текстурные координаты и пр.) по поверхности полигона. Производится перспективная коррекция текстурных координат. С этого момента начинается пиксельный конвейер - данные обрабатываются попиксельно. 
<BR>5. Вычисление цвета. В программируемом конвейере результирующий цвет пикселя вычисляется во фрагментном шейдере. На этом этапе рассчитываются попиксельное освещение, текстурирование, рельеф, отражение, тени, прозрачность и другие эффекты. В качестве входных данных используются интерполированные вершинные атрибуты, а также текстуры.
<BR>6. Проверка глубины. Перед тем, как записать пиксель в буфер кадра, может быть произведена проверка глубины (depth test). Координата Z пикселя сравнивается с соответствующей глубиной в Z-буфере. Если она меньше, то пиксель должен быть отрисован, если нет - то проигнорирован.
<BR>7. Смешивание. Полученный цвет пикселя может по заданным правилам смешиваться с уже присутствующим цветом в буфере кадра. Итоговое значение записывается в буфер.
<BR>
<BR>Следует также учесть, что свой конвейер есть и у второго по распространенности метода 3D-рендеринга - трассировки лучей. Он более простой и интуитивный и оперирует, главным образом, лучами. Наборы вершин используются только для определения хода луча, буфера глубины нет, а перспективное проецирование осуществляется путем расчета стартового направления лучей для каждого пикселя изображения. Итоговый цвет пикселя рассчитывается схожим с фрагментным шейдером образом.
</A>
<HR>
<!-- <img src=../data/ShadingModel.jpg align="left"> -->
<DIV>

</BODY>
</HTML>
