<HTML>
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<TITLE>HDR</TITLE>
<LINK href="../data/style.css" type=text/css rel=stylesheet>
</HEAD>
<BODY>

<DIV ALIGN=justify>

<H1 class=name>HDR</H1>
<A class=type>High Dynamic Range | Широкий динамический диапазон</A>
<HR>
<A>
Описание цвета реальными физическими величинами. 
<BR><BR>Привычной моделью описания 
изображения является RGB, когда все цвета представлены в виде суммы основных цветов: красного, зеленого и синего, 
с разной интенсивностью в виде возможных целочисленных значений от 0 до 255 для каждого, закодированных восемью 
битами на цвет. Отношение максимальной интенсивности к минимальной, доступной для отображения конкретной моделью 
или устройством, называется динамическим диапазоном. Так, динамический диапазон модели RGB составляет 256:1 или 
100:1 cd/m2 (два порядка). Эта модель описания цвета и интенсивности общепринято называется Low Dynamic Range (LDR).
<BR><BR>Возможных значений LDR для всех случаев явно недостаточно, человек способен видеть гораздо больший диапазон, 
особенно при малой интенсивности света, а модель RGB слишком ограничена в таких случаях (да и при больших 
интенсивностях тоже). Динамический диапазон зрения человека от 10-6 до 108 cd/m2, то есть 100000000000000:1 (14 порядков). 
Одновременно весь диапазон мы видеть не можем, но диапазон, видимый глазом в каждый момент времени, примерно 
равен 10000:1 (4 порядка). Зрение приспосабливается к значениям из другой части диапазона освещенности постепенно, 
при помощи так называемой адаптации, которую легко описать ситуацией с выключением света в комнате в темное время 
суток - сначала глаза видят очень мало, но со временем адаптируются к изменившимся условиям освещения и видят уже 
намного больше. То же самое случается и при обратной смене темной среды на светлую.
<BR><BR>Итак, динамического диапазона модели описания RGB недостаточно для представления изображений, которые человек 
способен видеть в реальности, эта модель значительно уменьшает возможные значения интенсивности света в верхней и 
нижней части диапазона. Самый распространенный пример, приводимый в материалах по HDR, - изображение затемненного 
помещения с окном на яркую улицу в солнечный день. С RGB моделью можно получить или нормальное отображение того, 
что находится за окном, или только того, что внутри помещения. Значения больше 100 cd/m 2 в LDR вообще обрезаются, 
это является причиной тому, что в 3D-рендеринге трудно правильно отображать яркие источники света, направленные 
прямо в камеру.
<BR><BR>Сами устройства отображения данных пока что серьезно улучшить нельзя, но отказ от LDR при расчетах имеет смысл. 
Можно использовать реальные физические величины интенсивности и цвета (или линейно пропорциональные), а на монитор 
выводить максимум того, что он сможет. Суть представления HDR в использовании значений интенсивности и цвета в реальных 
физических величинах или линейно пропорциональных и в том, чтобы использовать не целые числа, а числа с плавающей запятой 
с большой точностью (например, 16 или 32 бита). Это снимет ограничения модели RGB, а динамический диапазон изображения 
серьезно увеличится. Затем любое HDR изображение можно вывести на любом средстве отображения (том же RGB мониторе), 
с максимально возможным качеством для него при помощи специальных алгоритмов tone mapping.
<BR><BR>HDR рендеринг позволяет изменять экспозицию уже после того, как мы отрендерили изображение, дает возможность 
имитировать эффект адаптации человеческого зрения (перемещение из ярких открытых пространств в темные помещения и наоборот), 
позволяет выполнять физически правильное освещение, а также является унифицированным решением для применения эффектов 
постобработки (glare, flares, bloom, motion blur). Алгоритмы обработки изображения, цветокоррекцию, гамма-коррекцию, 
motion blur, bloom и другие методы постобработки качественней выполнять в HDR представлении.
<BR><BR>В приложениях 3D рендеринга реального времени (играх, в основном) HDR рендеринг начали использовать относительно недавно, 
ведь это требует вычислений и поддержки render target в форматах с плавающей точкой, которые впервые стали доступны только 
на видеочипах с поддержкой DirectX 9. Обычный путь HDR рендеринга в играх таков: рендеринг сцены в буфер формата с плавающей точкой, 
постобработка изображения в расширенном цветовом диапазоне (изменение контраста и яркости, цветового баланса, эффекты glare 
и motion blur, lens flare и подобные), применение tone mapping для вывода итоговой HDR картинки на LDR-экран. 
Иногда используются карты среды (environment maps) в HDR форматах, для статических отражений на объектах, весьма интересны 
применения HDR в имитации динамических преломлений и отражений, для этого также могут использоваться динамические карты в 
форматах с плавающей точкой. К этому можно добавить еще лайтмапы (light maps), заранее рассчитанные и сохраненные в HDR формате. 
Многое из перечисленного сделано, например, в Half-Life 2: Lost Coast.
<BR><BR>HDR рендеринг очень полезен для комплексной постобработки более высокого качества, по сравнению с обычными методами. 
Тот же bloom будет выглядеть реалистичнее при расчетах в HDR модели представления.
<BR><BR>К сожалению, в некоторых случаях разработчики игр могут скрывать под названием HDR просто фильтр bloom, рассчитываемый в 
обычном LDR-диапазоне. И хотя большая часть в том, что сейчас делают в играх с HDR рендерингом, как раз и есть bloom лучшего качества, 
выгода от HDR рендеринга не ограничивается одним этим постэффектом, просто его сделать легче всего.
<BR>
</A>
<HR>
<img src=../data/hdr.jpg align="left">
<DIV>

</BODY>
</HTML>
