<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Tutorial 9. Skeletal animation</title>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
    <meta charset="windows-1251">
    <meta name="author" content="Gecko">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="../sakura.css" inline>
    <link rel="stylesheet" type="text/css" href="../github.css" inline>
</head>
<body>
<h1 id="9">Урок 9. Основы скелетной анимации</h1>
<p>Порой возможностей вертексной анимации оказывается недостаточно. Это касается, в основном, игр жанра action. Например, вы можете захотеть "дать" своему герою в руки оружие или "надеть" на него броню. При использовании вершинной анимации это невозможно (за редкими исключениями). Кроме того, вершинная анимация может потребовать слишком много памяти для хранения кадров. Поэтому, если вы используете модели с большим количеством полигонов, разумнее будет выбрать скелетную анимацию.</p>
<p>Вместо того чтобы хранить ключевые кадры (как в случае вертексной анимации) для каждой позы персонажа, использование скелетной анимации подразумевает наличие одной модели в нейтральной позе и большого набора матриц, которые трансформируют различные части этой модели. Эти матрицы условно называют костями. К каждой кости привязана группа вершин. Одна вершина может "принадлежать" нескольким костям сразу, с разной степенью влияния, что делает анимацию более естественной (это свойство костей называется развесовкой).</p>
<p>Впервые эта технология использовалась в игре Half-Life, и Xtreme3D поддерживает формат моделей Half-Life - SMD. В качестве альтернативы SMD, поддерживается также формат моделей Doom III - MD5.</p>
<p>Для загрузки моделей со скелетной анимацией используется тот же объект Actor. Вам не нужно ничего дополнительно указывать, Xtreme3D способен самостоятельно распознать тип модели и настроиться на соответствующий тип анимации: </p>
<pre class="gml language-gml"><code class="hljs gml language-gml">actor = ActorCreate(<span class="hljs-string">&quot;model.smd&quot;</span>, matlib, matlib, <span class="hljs-symbol">global</span>.scene);
</code></pre>
<p>Особенность формата SMD заключается в том, что анимация модели хранится в отдельном файле, который также имеет расширение *.smd. Таких файлов может быть несколько. Теоретически, такой метод позволяет использовать одни и те же файлы анимации для разных моделей (если они имеют одинаковый скелет).</p>
<p>После создания Актера следует добавить эти файлы: </p>
<pre class="gml language-gml"><code class="hljs gml language-gml">ActorAddObject(actor, <span class="hljs-string">&quot;animation1.smd&quot;</span>);
ActorAddObject(actor, <span class="hljs-string">&quot;animation2.smd&quot;</span>);
ActorAddObject(actor, <span class="hljs-string">&quot;animation3.smd&quot;</span>);
</code></pre>
<p>При добавлении очередного smd-файла, к анимации актера добавляется новая группа кадров, которой присваивается порядковый номер. Отсчет ведется с 1. То есть, если мы теперь переключимся на группу 2:</p>
<pre class="gml language-gml"><code class="hljs gml language-gml">ActorSwitchToAnimation(actor, <span class="hljs-number">2</span>, <span class="hljs-symbol">false</span>);
</code></pre>
<p>…то будет проиграна анимация, загруженная из файла animation2.smd.</p>
<p>К скелетной анимации применимы все функции, которые мы рассмотрели на предыдущем уроке.</p>
</body>
</html>
