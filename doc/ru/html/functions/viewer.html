<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Viewer</title>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
    <meta charset="windows-1251">
    <meta name="author" content="Gecko">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="../style.css" inline>
</head>
<body>
<h1 id="viewer">Viewer</h1>
<p>Видом (Viewer) в Xtreme3D называется область окна, в которой происходит отрисовка 3D-сцены. Вы можете создать несколько независимых видов, и все они могут отображать сцену с различных ракурсов.</p>
<hr />
<h2 id="viewercreate">ViewerCreate</h2>
<p><code>real ViewerCreate(real x, real y, real width, real height, real windowHandle);</code></p>
<p>Создает новый вид и возвращает ссылку на него.</p>
<ul>
<li><code>x</code>, <code>y</code> - координаты вида (левый верхний угол) относительно родительского окна;</li>
<li><code>width</code>, <code>height</code> - ширина и высота вида;</li>
<li><code>windowHandle</code> - дескриптор окна (HWND), к которому следует привязать движок. Дескриптор окна игры в GML возвращается функцией <code>window_handle()</code>. В GameMaker: Studio 2 эта функция возвращает не <code>real</code>, а <code>ptr</code> (указатель). GML, к сожалению, не поддерживает передачу указателей в DLL-функции напрямую, поэтому нужно перевести это значение в <code>real</code>, прежде чем передавать во <code>ViewerCreate</code>. Для этого в Xtreme3D предусмотрена функция <a href="engine.html#pointertoreal">PointerToReal</a>:</li>
</ul>
<pre><code class="gml language-gml">viewer = ViewerCreate(0, 0, window_get_width(), window_get_height(), PointerToReal(windowHandle));
</code></pre>
<hr />
<h2 id="viewersetcamera">ViewerSetCamera</h2>
<p><code>real ViewerSetCamera(real viewer, real camera);</code></p>
<p>Определяет камеру, которую должен использовать вид для отрисовки проекции на сцену. Можно использовать одну и ту же камеру для нескольких видов, но обычно каждому виду назначается своя отдельная камера.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>camera</code> - ссылка на камеру.</li>
</ul>
<hr />
<h2 id="viewerenablevsync">ViewerEnableVSync</h2>
<p><code>real ViewerEnableVSync(real viewer, real vsm);</code></p>
<p>Включает или выключает вертикальную синхронизацию для вида. Существует распространенная проблема, когда обновление экрана расходится во времени с рендерингом кадров. Эта функция решает проблему, синхронизируя видеокарту с монитором так, что FPS не превысит частоту обновления экрана. Это и называется вертикальной синхронизацией.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>vsm</code> - <code>vsmSync</code> или <code>vsmNoSync</code> (0 и 1 соответственно).</li>
</ul>
<hr />
<h2 id="viewerrender">ViewerRender</h2>
<p><code>real ViewerRender(real viewer);</code></p>
<p>Совершает рендеринг вида - отрисовку проекции и вывод на экран. Эта функция рендерит все существующие объекты сцены.</p>
<ul>
<li><code>viewer</code> - ссылка на вид.</li>
</ul>
<hr />
<h2 id="viewerrenderobject">ViewerRenderObject</h2>
<p><code>real ViewerRenderObject(real viewer, real obj);</code></p>
<p>Совершает рендеринг указанного объекта в виде.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>obj</code> - ссылка на объект.</li>
</ul>
<hr />
<h2 id="viewerrendertofile">ViewerRenderToFile</h2>
<p><code>real ViewerRenderToFile(real viewer, string filename);</code></p>
<p>Совершает рендеринг вида в файл BMP или PNG (иными словами, делает скриншот).</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>filename</code> - имя файла.</li>
</ul>
<hr />
<h2 id="viewerresize">ViewerResize</h2>
<p><code>real ViewerResize(real viewer, real x, real y, real width, real height);</code></p>
<p>Изменяет позицию и размер вида. Обычно в играх это не требуется, но может пригодиться, например, если вы даете игроку возможность растягивать окно в оконном режиме. Обратите внимание, что эта функция довольно медленная и не должна вызываться постоянно.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - новые координаты вида (левый верхний угол) относительно левого верхнего угла родительского окна</li>
<li><code>width</code>, <code>height</code> - новые ширина и высота вида.</li>
</ul>
<hr />
<h2 id="viewergetsize">ViewerGetSize</h2>
<p><code>real ViewerGetSize(real viewer, real index);</code></p>
<p>Возвращает ширину или высоту вида. </p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>index</code> - если этот параметр равен 0, функция возвращает ширину, если 1 - высоту.</li>
</ul>
<hr />
<h2 id="viewergetposition">ViewerGetPosition</h2>
<p><code>real ViewerGetPosition(real viewer, real index);</code></p>
<p>Возвращает позицию вида (координату левого верхнего угла) относительно левого верхнего угла родительского окна.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>index</code> - если этот параметр равен 0, функция возвращает координату X, если 1 - Y.</li>
</ul>
<hr />
<h2 id="viewersetvisible">ViewerSetVisible</h2>
<p><code>real ViewerSetVisible(real viewer, real mode);</code></p>
<p>Прячет или показывает вид. Помните, что рендеринг для спрятанного вида не прекращается автоматически - для остановки рендеринга вам необходимо прекратить вызов ViewerRender для данного вида.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>mode</code> - true или false (1 и 0 соответственно).</li>
</ul>
<hr />
<h2 id="viewergetpixelcolor">ViewerGetPixelColor</h2>
<p><code>real ViewerGetPixelColor(real viewer, real x, real y);</code></p>
<p>Возвращает цвет пикселя на позиции x,y относительно верхнего левого угла вида.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - координаты пикселя.</li>
</ul>
<hr />
<h2 id="viewergetpixeldepth">ViewerGetPixelDepth</h2>
<p><code>real ViewerGetPixelDepth(real viewer, real x, real y);</code></p>
<p>Возвращает глубину пикселя в Z-буфере на позиции x,y относительно верхнего левого угла вида.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - координаты пикселя.</li>
</ul>
<hr />
<h2 id="viewersetlighting">ViewerSetLighting</h2>
<p><code>real ViewerSetLighting(real viewer, real mode);</code></p>
<p>Включает или выключает освещение для вида. Если освещение включено, при отрисовке объектов будут учтены источники света, в ином случае объекты будут отрисованы плоско, без затенения.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>mode</code> - true или false (1 и 0 соответственно).</li>
</ul>
<hr />
<h2 id="viewersetbackgroundcolor">ViewerSetBackgroundColor</h2>
<p><code>real ViewerSetBackgroundColor(real viewer, real color);</code></p>
<p>Определяет фоновой цвет вида. Это цвет, которым по умолчанию заполняется все пустое пространство позади объектов. Это не очень эффектно, но в некоторых случаях достаточно.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>color</code> - цвет.</li>
</ul>
<hr />
<h2 id="viewersetambientcolor">ViewerSetAmbientColor</h2>
<p><code>real ViewerSetAmbientColor(real viewer, real color);</code></p>
<p>Определяет цвет окружения вида. Цвет окружения используется для задания общего оттенка объектов отдельно от источников света и вне зависимости от их собственных цветов. Можно привести такой пример: ночью все предметы, особенно белые, в неярком свете кажутся голубоватыми, независимо от их собственного цвета. Похожий эффект наблюдается и при использовании инфракрасной камеры.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>color</code> - цвет.</li>
</ul>
<hr />
<h2 id="viewerenablefog">ViewerEnableFog</h2>
<p><code>real ViewerEnableFog(real viewer, real mode);</code></p>
<p>Включает или выключает туман для вида. Туман - это очень распространенный эффект. Все объекты дальше определенного расстояния постепенно окрашиваются в заданный цвет по мере отдаления. Самые дальние объекты уже не имеют собственного цвета и, как предполагается, должны полностью слиться с фоном.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>mode</code> - true или false (1 и 0 соответственно).</li>
</ul>
<hr />
<h2 id="viewersetfogcolor">ViewerSetFogColor</h2>
<p><code>real ViewerSetFogColor(real viewer, real color);</code></p>
<p>Определяет цвет тумана.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>color</code> - цвет.</li>
</ul>
<hr />
<h2 id="viewersetfogdistance">ViewerSetFogDistance</h2>
<p><code>real ViewerSetFogDistance(real viewer, real start, real end);</code></p>
<p>Определяет расстояние "затуманивания".</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>start</code> - минимальное расстояние, объекты ближе которого не подвергаются действию тумана</li>
<li><code>end</code> - максимальное расстояние, на котором объекты полностью окрашены в цвет тумана.</li>
</ul>
<hr />
<h2 id="viewerscreentoworld">ViewerScreenToWorld</h2>
<p><code>real ViewerScreenToWorld(real viewer, real x, real y, real ind);</code></p>
<p>Конвертирует двумерные координаты на экране в абсолютные трехмерные координаты сцены. За (0, 0) берется левый нижний угол экрана.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - координаты на экране</li>
<li><code>ind</code> - определяет, какую координату должна возвращать функция: x если ind=0, y если ind=1, z если ind=2.</li>
</ul>
<hr />
<h2 id="viewerworldtoscreen">ViewerWorldToScreen</h2>
<p><code>real ViewerWorldToScreen(real viewer, real x, real y, real z, real ind);</code></p>
<p>Конвертирует абсолютные трехмерные координаты сцены в двумерные координаты на экране. За (0, 0) берется левый нижний угол экрана.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - координаты на экране</li>
<li><code>ind</code> - определяет, какую координату должна возвращать функция: x если ind=0, y если ind=1, z если ind=2.</li>
</ul>
<hr />
<h2 id="viewerpixelraytoworld">ViewerPixelRayToWorld</h2>
<p><code>real ViewerPixelRayToWorld(real viewer, real x, real y, real ind);</code></p>
<p>Конвертирует двумерные координаты вида x и y в трехмерные координаты сцены и возвращает индекс кординаты.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - координаты на экране</li>
<li><code>ind</code> - определяет, какую координату должна возвращать функция: x если ind=0, y если ind=1.</li>
</ul>
<hr />
<h2 id="viewercopytotexture">ViewerCopyToTexture</h2>
<p><code>real ViewerCopyToTexture(real viewer, string material);</code></p>
<p>Копирует содержимое вида (отрисованное изображение) в текстуру материала. Обратите внимание, что эта функция работает только в том случае, когда ширина и высота вида соответствуют степеням двойки (512, 256, 128 и т.д.).</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>material</code> - имя материала.</li>
</ul>
<hr />
<h2 id="viewergetframespersecond">ViewerGetFramesPerSecond</h2>
<p><code>real ViewerGetFramesPerSecond(real viewer);</code></p>
<p>Возвращает количество кадров в секунду, отрисовываемое видом (frames per second, FPS).</p>
<ul>
<li><code>viewer</code> - ссылка на вид.</li>
</ul>
<hr />
<h2 id="viewergetpickedobject">ViewerGetPickedObject</h2>
<p><code>real ViewerGetPickedObject(real viewer, real x, real y);</code></p>
<p>Возвращает ближайший объект, которому соответствует заданная точка на экране.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - координаты точки.</li>
</ul>
<hr />
<h2 id="viewergetpickedobjectslist">ViewerGetPickedObjectsList</h2>
<p><code>real ViewerGetPickedObjectsList(real viewer, real list, real x, real y, real w, real h, real num);</code></p>
<p>Сохраняет в список объекты, которые попадают в заданную прямоугольную область на экране.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>list</code> - id списка PickList</li>
<li><code>x</code>, <code>y</code> - координаты верхнего левого угла прямоугольника</li>
<li><code>w</code>, <code>h</code> - ширина и высота прямоугольника</li>
<li><code>num</code> - приблизительное ожидаемое количество объектов.</li>
</ul>
<hr />
<h2 id="viewerscreentovector">ViewerScreenToVector</h2>
<p><code>real ViewerScreenToVector(real viewer, real x, real y, real ind);</code></p>
<p>Вычисляет единичный вектор от позиции камеры вида к заданной точке на экране.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - координаты на экране</li>
<li><code>ind</code> - индекс координаты вектора (0 = X, 1 = Y, 2 = Z).</li>
</ul>
<hr />
<h2 id="viewervectortoscreen">ViewerVectorToScreen</h2>
<p><code>real ViewerVectorToScreen(real viewer, real x, real y, real z, real ind);</code></p>
<p>Вычисляет координаты точки на экране, соответствующей заданному единичному вектору от позиции камеры вида.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code>, <code>z</code> - вектор</li>
<li><code>ind</code> - индекс координаты точки (0 = X, 1 = Y).</li>
</ul>
<hr />
<h2 id="viewerpixeltodistance">ViewerPixelToDistance</h2>
<p><code>real ViewerPixelToDistance(real viewer, real x, real y);</code></p>
<p>Вычисляет расстояние от позиции камеры вида до ближайшего объекта, которому соответствует заданная точка на экране.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>x</code>, <code>y</code> - координаты на экране.</li>
</ul>
<hr />
<h2 id="viewersetantialiasing">ViewerSetAntiAliasing</h2>
<p><code>real ViewerSetAntiAliasing(real viewer, real aa);</code></p>
<p>Задает режим антиалиасинга (сглаживания) для вида, если это поддерживается видеодрайвером.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>aa</code> - режим антиалиасинга. Доступны следующие значения aa:</li>
<li><code>aaDefault</code> = 0 - значение по умолчанию (использовать настройку драйвера);</li>
<li><code>aaNone</code> = 1 - антиалиасинг отключен;</li>
<li><code>aa2x</code> = 2 - двойной MSAA;</li>
<li><code>aa2xHQ</code> = 3 - двойной MSAA с технологией Quincunx (на видеокартах от NVIDIA);</li>
<li><code>aa4x</code> = 4 - четвертной MSAA;</li>
<li><code>aa4xHQ</code> = 5 - четвертной MSAA с технологией Quincunx (на видеокартах от NVIDIA);</li>
<li><code>aa6x</code> = 6 - 6-кратный MSAA;</li>
<li><code>aa8x</code> = 7 - 8-кратный MSAA;</li>
<li><code>aa16x</code> = 8 - 16-кратный MSAA;</li>
<li><code>csa8x</code> = 9 - 8-кратный CSAA;</li>
<li><code>csa8xHQ</code> = 10 - 8-кратный CSAA с технологией Quincunx (на видеокартах от NVIDIA);</li>
<li><code>csa16x</code> = 11 - 16-кратный CSAA;</li>
<li><code>csa16xHQ</code> = 12 - 16-кратный CSAA с технологией Quincunx (на видеокартах от NVIDIA).</li>
</ul>
<hr />
<h2 id="viewershademodel">ViewerShadeModel</h2>
<p><code>real ViewerShadeModel(real viewer, real smooth);</code></p>
<p>Задает тип освещения на полигонах - плоское или сглаженное.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>smooth</code> - <code>true</code> (сглаженное освещение) или <code>false</code> (плоское освещение) (1 и 0 соответственно).</li>
</ul>
<hr />
<h2 id="viewergetfbosupported">ViewerGetFBOSupported</h2>
<p><code>real ViewerGetFBOSupported(real viewer);</code></p>
<p>Возвращает истину, если видеодрайвер поддерживает кадровые буферы (FBO).</p>
<ul>
<li><code>viewer</code> - ссылка на вид.</li>
</ul>
<hr />
<h2 id="viewergetvbosupported">ViewerGetVBOSupported</h2>
<p><code>real ViewerGetVBOSupported(real viewer);</code></p>
<p>Возвращает истину, если видеодрайвер поддерживает вершинные буферы (VBO).</p>
<ul>
<li><code>viewer</code> - ссылка на вид.</li>
</ul>
<hr />
<h2 id="viewergetglslsupported">ViewerGetGLSLSupported</h2>
<p><code>real ViewerGetGLSLSupported(real viewer);</code></p>
<p>Возвращает истину, если видеодрайвер поддерживает шейдеры на языке GLSL.</p>
<ul>
<li><code>viewer</code> - ссылка на вид.</li>
</ul>
<hr />
<h2 id="viewerisopenglextensionsupported">ViewerIsOpenGLExtensionSupported</h2>
<p><code>real ViewerIsOpenGLExtensionSupported(real viewer, string ext);</code></p>
<p>Возвращает истину, если видеодрайвер поддерживает заданное расширение OpenGL. С помощью этой функции можно заранее проверить, будут ли работать на целевой машине те или иные функции Xtreme3D, и предпринять соответствующие меры - например, вывести информативное сообщение об ошибке. Если какая-то функция зависит от расширения, в данной справке это оговорено в ее описании.</p>
<ul>
<li><code>viewer</code> - ссылка на вид;</li>
<li><code>ext</code> - полное название расширения (например, <code>"GL_ARB_texture_float"</code> или <code>"GL_NV_occlusion_query"</code>).</li>
</ul>
<hr />
<h2 id="viewerresetperformancemonitor">ViewerResetPerformanceMonitor</h2>
<p><code>real ViewerResetPerformanceMonitor(real viewer);</code></p>
<p>Сбрасывает счетчик частоты кадров вида.</p>
<ul>
<li><code>viewer</code> - ссылка на вид.</li>
</ul>
</body>
</html>
