# Engine

Функции движка (Engine), в отличие от остальных, не относятся к какому-либо классу объектов. Они служат для общего управления Xtreme3D и задания базовых параметров движка.

---

## EngineCreate

`real EngineCreate();`

Инициализирует Xtreme3D. После вызова этой функции вы можете использовать другие функции движка. Инициализация движка может происходить только один раз за одно время, то есть, вы не можете снова вызвать эту функцию, пока не будет выполнена [EngineDestroy](engine.html#enginedestroy).

---

## EngineDestroy

`real EngineDestroy();`

Уничтожает Xtreme3D, освобождая память из-под всех его ресурсов. После вызова этой функции вы не можете использовать другие функции движка, пока не будет выполнена [EngineCreate](engine.html#enginecreate).

---

## EngineSetObjectsSorting

`real EngineSetObjectsSorting(real os);`

Определяет режим сортировки (`os`) для всех объектов. Доступны следующие константы для os:
- `osInherited = 0` - унаследованная сортировка;
- `osNone = 1` - отсутствие сортировки;
- `osRenderFarthestFirst = 2` - отрисовка первыми объектов с максимальным удалением от камеры (значение по умолчанию);
- `osRenderBlendedLast = 3` - непрозрачные объекты не сортируются и отрисовываются первыми, прозрачные - последними, и с учетом глубины;
- `osRenderNearestFirst = 4` - отрисовка первыми объектов с минимальным удалением от камеры.

---

## EngineSetCulling

`real EngineSetCulling(real vs);`

Определяет режим отбора видимости (`vc`) для всех объектов. Доступны следующие константы для vc:
- `vcNone = 0` - отсутствие отбора видимости;
- `vcInherited = 1` - унаследованный отбор видимости;
- `vcObjectBased = 2` - отбор совершается на основе объекта: каждый объект может быть отобран в зависимости от своей позиции. Отбор объекта не затрагивает видимость его дочерних объектов;
- `vcHierarchical = 3` - отбор осуществляется по принципу иерархии: если материнский объект отобран, все его дочерние объекты также будут невидимы.
В зависимости от структуры вашей сцены, наиболее эффективными методами будут `vcObjectBased` и `vcHierarchical`.

---

## EngineUpdate

`real EngineUpdate(real delta);`

Совершает шаг итерации движка. В этой функции происходит обновление анимированных объектов - таких, как актеры, эффекты частиц и др. Функция обычно вызывается перед [ViewerRender](viewer.html#viewerrender).
- `dt` - шаг времени в секундах (дельта времени). Обычно шаг времени обратно пропорционален количеству кадров в секунду (1 / FPS). Например, при 60 FPS шаг времени должен быть равен 1/60. Меняя этот параметр, можно менять скорость анимации и сделать эффект замедления или ускорения событий.

---

## EngineSaveScene

`real EngineSaveScene(string filename);`

Сохраняет все объекты сцены в файл. Функция экспериментальная, с некоторыми типами объектов она может работать некорректно.

- `filename` - имя файла.

---

## EngineLoadScene

`real EngineLoadScene(string filename);`

Удаляет все объекты сцены и загружает новые из файла. Функция экспериментальная, с некоторыми типами объектов она может работать некорректно.

- `filename` - имя файла.

---

## EngineRootObject

`real EngineRootObject();`

Возвращает указатель корневого объекта сцены - то есть, объекта, потомками которого являются объекты с нулевым родителем. Манипуляции с этим объектом нужно производить крайне осторожно, с четким пониманием того, что вы делаете! Ни в коем случае не удаляйте корневой объект - это приведет к неработоспособности движка.

---

## EngineShowLoadingErrors

`real EngineShowLoadingErrors(real mode);`

Переключает вывод сообщений об ошибках при неудачных загрузках моделей и текстур.
- mode - `true` или `false` (1 и 0 соответственно).

---

## EngineSetMaxLights

`real EngineSetMaxLights(real lights);`

Задает максимальное количество динамических источников света в движке. По умолчанию это значение равно 8. Если вы используете систему LightFX, то функция задает общее количество источников в системе, и оно не ограничено. Если же вы используете базовую систему освещения, то функция все равно сработает, но максимальное количество источников будет ограничено возможностями видеодрайвера.
- `lights` - количество источников света.

---

## EngineGetTimeStep

`real EngineGetTimeStep();`

Возвращает время в секундах, прошедшее с предыдущего вызова EngineGetTimeStep (или с вызова [EngineCreate](engine.html#enginecreate), если функция вызывается впервые). Функцию можно использовать для реализации таймера, который необходим практически в любой игре. Например, если вы не используете GameMaker, то с помощью EngineGetTimeStep можете легко сделать таймер для обновления логики игры и вызова [EngineUpdate](engine.html#engineupdate) с фиксированной частотой 60 раз в секунду.

---

## EngineGetLastRaycastPosition

`real EngineGetLastRaycastPosition(real index);`

Возвращает абсолютные координаты точки пересечения объекта с лучом, обнаруженного последним вызовом функции [ObjectSceneRaycast](engine.html#objectsceneraycast) или [ObjectRaycast](engine.html#objectraycast).
- `index` - индекс координаты (0 = X, 1 = Y, 2 = Z).

---

## EngineGetLastRaycastNormal

`real EngineGetLastRaycastNormal(real index);`

Возвращает нормаль полигона пересечения объекта с лучом, обнаруженного последним вызовом функции [ObjectSceneRaycast](engine.html#objectsceneraycast) или [ObjectRaycast](engine.html#objectraycast).
- `index` - индекс координаты (0 = X, 1 = Y, 2 = Z).

---

## PointerToReal(pchar pointer)

`real PointerToReal(string pointer)`

Конвертирует указатель на строку в вещественное значение. Строковой указатель используется только для совместимости - вместо него может быть любой указатель. Функция нужна для удобства взаимодействия с GameMaker: Studio, где появился отдельный тип указателей.
- `pointer` - указатель.
