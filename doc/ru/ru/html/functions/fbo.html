<HTML>
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1251">
<TITLE>FBO</TITLE>
<LINK href="../data/style.css" type=text/css rel=stylesheet>
</HEAD>
<BODY>

<DIV ALIGN=justify>

<H1 class=pagetitle>FBO</H1>

<A class=type>Класс: TGLFBO</A><BR><BR>

<A>FBO (Frame Buffer Object) - это современный механизм внеэкранного рендеринга, пришедший на смену p-буферам (см. 
<A class=link href="memviewer.htm">MemoryViewer</A>). Как и MemoryViewer, FBO позволяет рендерить сцену в отдельный буфер в видеопамяти, содержимое которого затем становится доступным в качестве текстуры. Это позволяет производить над полученным изображением различные шейдерные операции постобработки, применять фильтры и спецэффекты.
<BR/>В отличие от MemoryViewer, FBO не требует относительно дорогостоящей операции переключения контекстов OpenGL, поэтому на современных системах предпочтительнее использовать именно его. Также FBO работает намного быстрее, чем 
</A><A class=funclink href=../functions/viewer.htm#ViewerCopyToTexture>ViewerCopyToTexture</A><A>, 
которая, фактически, совершает копирование данных из одного буфера в другой. Еще одно преимущество - FBO предоставляет полноценный доступ к Z-буферу, что необходимо для реализации некоторых фильтров. При этом пользоваться FBO ничуть не сложнее, чем MemoryViewer. Единственное ограничение состоит в том, что доступ к текстурам FBO возможен только через шейдеры GLSL - то есть, нельзя создать материал, который бы использовал FBO-текстуру без шейдера.
<BR/>Чтобы передать текстуры FBO в GLSL-шейдер, используйте функции 
</A><A class=funclink href=../functions/shader.htm#GLSLShaderSetParameterFBOColorTexture>GLSLShaderSetParameterFBOColorTexture</A><A> и 
</A><A class=funclink href=../functions/shader.htm#GLSLShaderSetParameterFBODepthTexture>GLSLShaderSetParameterFBODepthTexture</A><A> - 
соответственно, для цветового буфера и Z-буфера.
<BR/>Функции FBO требуют поддержки OpenGL 1.4 и расширения GL_ARB_framebuffer_object.
</A>
<HR>

<A name="FBOCreate"></A>
<H1 class=name>FBOCreate</H1>
<A class=type>real</A><A> = </A><A class=function>FBOCreate</A><A>( width,height,viewer as </A><A class=type>real</A><A> );</A>
<BR><A>Создает новый FBO и возвращает его id.</A>
<BR><A>width,height - ширина и высота буфера</A>
<BR><A>viewer - id вида, настройки которого нужно использовать для рендеринга (фоновой цвет, туман, соотношение сторон и т.д.).</A>
<HR>

<A name="FBOSetCamera"></A>
<H1 class=name>FBOSetCamera</H1>
<A class=type>real</A><A> = </A><A class=function>FBOSetCamera</A><A>( fbo,camera as </A><A class=type>real</A><A> );</A>
<BR><A>Задает камеру, через которую FBO должен рендерить сцену.</A>
<BR><A>fbo - id FBO</A>
<BR><A>camera - id камеры.</A>
<HR>

<A name="FBOSetViewer"></A>
<H1 class=name>FBOSetViewer</H1>
<A class=type>real</A><A> = </A><A class=function>FBOSetViewer</A><A>( fbo,viewer as </A><A class=type>real</A><A> );</A>
<BR><A>Задает вид, настройки которого нужно использовать для рендеринга (фоновой цвет, туман, соотношение сторон и т.д.).</A>
<BR><A>fbo - id FBO</A>
<BR><A>view - id вида.</A>
<HR>

<A name="FBORenderObject"></A>
<H1 class=name>FBORenderObject</H1>
<A class=type>real</A><A> = </A><A class=function>FBORenderObject</A><A>( fbo,object as </A><A class=type>real</A><A> );</A>
<BR><A>Совершает рендеринг объекта в FBO. Обратите внимание, что читать текстуры FBO во время рендеринга в него не рекомендуется, это приведет к неопределенному результату. Иными словами, избегайте ситуации, когда в FBO рендерится объект, использующий шейдер, который читает текстуру того же FBO.</A>
<BR><A>fbo - id FBO</A>
<BR><A>object - объект, который нужно отрендерить (вместе с его потомками). Как правило, в этот параметр передается Dummycube, содержащий иерархию 3D-сцены.</A>
<HR>

<A name="FBORenderObjectEx"></A>
<H1 class=name>FBORenderObjectEx</H1>
<A class=type>real</A><A> = </A><A class=function>FBORenderObjectEx</A><A>( fbo,object,clearcolor,cleardepth,copycolor,copydepth as </A><A class=type>real</A><A> );</A>
<BR><A>Совершает рендеринг объекта в FBO с расширенными опциями. Функция позволяет организовать многопроходный рендеринг.</A>
<BR><A>fbo - id FBO</A>
<BR><A>object - объект, который нужно отрендерить (вместе с его потомками). Как правило, в этот параметр передается Dummycube, содержащий иерархию 3D-сцены</A>
<BR><A>clearcolor - определяет, очищать ли FBO фоновым цветом перед рендерингом - 
<A class=constant>true</A> или <A class=constant>false</A> (1 и 0 соответственно)</A>
<BR><A>cleardepth - определяет, очищать ли буфер глубины FBO перед рендерингом - 
<A class=constant>true</A> или <A class=constant>false</A> (1 и 0 соответственно)</A>
<BR><A>copycolor - определяет, копировать ли содержимое цветового буфера FBO в главный кадровый буфер после рендеринга - 
<A class=constant>true</A> или <A class=constant>false</A> (1 и 0 соответственно)</A>
<BR><A>copydepth - определяет, копировать ли содержимое буфера глубины FBO в главный кадровый буфер после рендеринга - 
<A class=constant>true</A> или <A class=constant>false</A> (1 и 0 соответственно).</A>
<HR>

<A name="FBOSetOverrideMaterial"></A>
<H1 class=name>FBOSetOverrideMaterial</H1>
<A class=type>real</A><A> = </A><A class=function>FBOSetOverrideMaterial</A><A>( fbo,matlib as </A><A class=type>real</A><A>, material as </A><A class=type>string</A><A> );</A>
<BR/><A class=ntext>Задает FBO замещающий материал. Этот материал будет использован для всех объектов, которые рендерятся в FBO, а их собственные материалы будут игнорироваться. Эта возможность пригождается для реализации некоторых спецэффектов и техник рендеринга, таких как отложенный рендеринг. 
<BR/><A>fbo</A> - id FBO</A>
<BR/><A>matlib</A> - id библиотеки материалов</A>
<BR/><A>material</A> - имя материала в библиотеке. Если передать пустую строку, то замещающий материал будет отключен, и объекты будут, как обычно, рендериться со своими материалами.</A>
<HR>

<!--
<A name="FBOUseFloatColorBuffer"></A>
<H1 class=name>FBOUseFloatColorBuffer</H1>
<A class=type>real</A><A> = </A><A class=function>FBOUseFloatColorBuffer</A><A>( fbo,mode as </A><A class=type>real</A><A> );</A>
<BR/><A class=ntext>Определяет, использовать ли цветовой буфер формата 32-bit float (то есть, RGBA-буфер с 32-битным значением с плавающей запятой на каждый канал). Буфер такой точности необходим для хранения нецветовой информации.
<BR/><A>fbo</A> - id FBO</A>
<BR/><A>mode</A> - <A class=constant>true</A> или <A class=constant>false</A> (1 и 0 соответственно).</A>
<HR>
-->

<A name="FBOSetColorTextureFormat"></A>
<H1 class=name>FBOSetColorTextureFormat</H1>
<A class=type>real</A><A> = </A><A class=function>FBOSetColorTextureFormat</A><A>( fbo,tf as </A><A class=type>real</A><A> );</A>
<BR/><A class=ntext>Задает формат хранения текстуры цветового буфера FBO в видеопамяти (tf). Функция использует те же константы tf, что и  
</A><A class=funclink href=../functions/material.htm#MaterialSetTextureFormat>MaterialSetTextureFormat</A><A>
Поддерживаются следующие значения tf:</A>
<BR><A class=constant name="tfDefault">tfDefault</A><A> = 0 - формат по умолчанию (</A><A class=constant>tfRGBA</A><A>)</A>
<BR><A class=constant name="tfRGB">tfRGB</A><A> = 1 - 24-битный RGB, 8 бит на компонент, без альфа-канала</A>
<BR><A class=constant name="tfRGBA">tfRGBA</A><A> = 2 - 32-битный RGBA, 8 бит на компонент, включает альфа-канал</A>
<BR><A class=constant name="tfRGB16">tfRGB16</A><A> = 3 - 16-битный RGB, 5 бит на компонент, без альфа-канала</A>
<BR><A class=constant name="tfRGBA16">tfRGBA16</A><A> = 4 - 16-битный RGBA, 4 бита на компонент, включает альфа-канал</A>
<BR><A class=constant name="tfAlpha">tfAlpha</A><A> = 5 - только 8-битный альфа-канал без цвета</A>
<BR><A class=constant name="tfLuminance">tfLuminance</A><A> = 6 - только 8-битный компонент яркости, без альфа-канала</A>
<BR><A class=constant name="tfLuminanceAlpha">tfLuminanceAlpha</A><A> = 7 - только 8-битный компонент яркости, включает альфа-канал</A>
<BR><A class=constant name="tfIntensity">tfIntensity</A><A> = 8 - только 8-битный компонент насыщенности, без альфа-канала</A>
<BR><A class=constant name="tfRGBAFloat16">tfRGBAFloat16</A><A> = 10 - 16-битный RGBA с плавающей запятой, включает альфа-канал</A>
<BR><A class=constant name="tfRGBAFloat32">tfRGBAFloat32</A><A> = 11 - 32-битный RGBA с плавающей запятой, включает альфа-канал.</A>
<BR>Последние два формата требуют поддержки расширения GL_ARB_texture_float.
<BR/><A>fbo</A> - id FBO</A>
<BR><A>tf - формат.</A>
<HR>

</DIV>

</BODY>
</HTML>
